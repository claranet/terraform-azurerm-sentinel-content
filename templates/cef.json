{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "location": {
            "type": "String",
            "minLength": 1,
            "defaultValue": "[resourceGroup().location]",
            "metadata": {
                "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
            }
        },
        "workspace-location": {
            "type": "String",
            "defaultValue": "",
            "metadata": {
                "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
            }
        },
        "workspace": {
            "defaultValue": "",
            "type": "String",
            "metadata": {
                "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
            }
        }
    },
    "resources": [
        {
            "name": "pid-04050cde-d5d0-47ee-8577-c53e3dd96f3e-partnercenter",
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2020-10-01",
            "properties": {
                "mode": "Incremental",
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "resources": []
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring('CEF')))]",
            "location": "[parameters('workspace-location')]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', 'azuresentinel.azure-sentinel-solution-commoneventformat')]"
            ],
            "properties": {
                "description": "Common Event Format (CEF) is an industry standard format on top of Syslog messages. used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel. you can take advantage of search & correlation. alerting. and threat intelligence enrichment for each log. For more information. see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223902&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
                "mainTemplate": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0",
                    "parameters": {},
                    "variables": {},
                    "resources": [
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/','CEF')]",
                            "apiVersion": "2021-03-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
                            "location": "[parameters('workspace-location')]",
                            "kind": "GenericUI",
                            "properties": {
                                "connectorUiConfig": {
                                    "id": "CEF",
                                    "title": "Common Event Format (CEF)",
                                    "publisher": "Any",
                                    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223902&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
                                    "graphQueries": [
                                        {
                                            "metricName": "Total data received",
                                            "legend": "CommonSecurityLog",
                                            "baseQuery": "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n"
                                        }
                                    ],
                                    "sampleQueries": [
                                        {
                                            "query": "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\")\n\n            | sort by TimeGenerated"
                                        }
                                    ],
                                    "dataTypes": [
                                        {
                                            "name": "CommonSecurityLog",
                                            "lastDataReceivedQuery": "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                                        }
                                    ],
                                    "connectivityCriterias": [
                                        {
                                            "type": "IsConnectedQuery",
                                            "value": [
                                                "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
                                            ]
                                        }
                                    ],
                                    "availability": {
                                        "status": 1,
                                        "isPreview": false
                                    },
                                    "permissions": {
                                        "resourceProvider": [
                                            {
                                                "provider": "Microsoft.OperationalInsights/workspaces",
                                                "permissionsDisplayText": "read and write permissions.",
                                                "providerDisplayName": "Workspace",
                                                "scope": "Workspace",
                                                "requiredPermissions": {
                                                    "read": true,
                                                    "write": true,
                                                    "delete": true
                                                }
                                            },
                                            {
                                                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                                                "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                                                "providerDisplayName": "Keys",
                                                "scope": "Workspace",
                                                "requiredPermissions": {
                                                    "action": true
                                                }
                                            }
                                        ]
                                    },
                                    "instructionSteps": [
                                        {
                                            "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
                                            "innerSteps": [
                                                {
                                                    "title": "1.1 Select or create a Linux machine",
                                                    "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
                                                },
                                                {
                                                    "title": "1.2 Install the CEF collector on the Linux machine",
                                                    "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                                                    "instructions": [
                                                        {
                                                            "parameters": {
                                                                "fillWith": [
                                                                    "WorkspaceId",
                                                                    "PrimaryKey"
                                                                ],
                                                                "label": "Run the following command to install and apply the CEF collector:",
                                                                "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                                                            },
                                                            "type": "CopyableLabel"
                                                        }
                                                    ]
                                                }
                                            ],
                                            "title": "1. Linux Syslog agent configuration"
                                        },
                                        {
                                            "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine\u2019s IP address.",
                                            "title": "2. Forward Common Event Format (CEF) logs to Syslog agent"
                                        },
                                        {
                                            "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
                                            "instructions": [
                                                {
                                                    "parameters": {
                                                        "fillWith": [
                                                            "WorkspaceId"
                                                        ],
                                                        "label": "Run the following command to validate your connectivity:",
                                                        "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                                                    },
                                                    "type": "CopyableLabel"
                                                }
                                            ],
                                            "title": "3. Validate connection"
                                        },
                                        {
                                            "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
                                            "title": "4. Secure your machine "
                                        }
                                    ]
                                }
                            }
                        },
                        {
                            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
                            "apiVersion": "2023-04-01-preview",
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CEF'),'/'))))]",
                            "properties": {
                                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CEF')]",
                                "contentId": "CEF",
                                "kind": "DataConnector",
                                "version": "1.0.0",
                                "source": {
                                    "kind": "Solution",
                                    "name": "Common Event Format",
                                    "sourceId": "azuresentinel.azure-sentinel-solution-commoneventformat"
                                },
                                "author": {
                                    "name": "Microsoft",
                                    "email": "support@microsoft.com"
                                },
                                "support": {
                                    "tier": "Microsoft",
                                    "name": "Microsoft Corporation",
                                    "link": "https://support.microsoft.com",
                                    "email": "support@microsoft.com"
                                }
                            }
                        }
                    ]
                },
                "packageKind": "Solution",
                "packageVersion": "3.0.6",
                "packageName": "Common Event Format",
                "packageId": "azuresentinel.azure-sentinel-solution-commoneventformat",
                "contentSchemaVersion": "3.0.0",
                "contentId": "CEF",
                "contentKind": "DataConnector",
                "displayName": "Common Event Format (CEF)",
                "contentProductId": "azuresentinel.azure-sentinel-solution-commoneventf-dc-4hq43gtvy72xa",
                "id": "azuresentinel.azure-sentinel-solution-commoneventf-dc-4hq43gtvy72xa",
                "version": "1.0.0",
                "isDeprecated": false
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CEF'),'/'))))]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CEF')]"
            ],
            "location": "[parameters('workspace-location')]",
            "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CEF')]",
                "contentId": "CEF",
                "kind": "DataConnector",
                "version": "1.0.0",
                "source": {
                    "kind": "Solution",
                    "name": "Common Event Format",
                    "sourceId": "azuresentinel.azure-sentinel-solution-commoneventformat"
                },
                "author": {
                    "name": "Microsoft",
                    "email": "support@microsoft.com"
                },
                "support": {
                    "tier": "Microsoft",
                    "name": "Microsoft Corporation",
                    "link": "https://support.microsoft.com",
                    "email": "support@microsoft.com"
                }
            }
        },
        {
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/','CEF')]",
            "apiVersion": "2021-03-01-preview",
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "location": "[parameters('workspace-location')]",
            "kind": "GenericUI",
            "properties": {
                "connectorUiConfig": {
                    "title": "Common Event Format (CEF)",
                    "publisher": "Any",
                    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223902&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
                    "graphQueries": [
                        {
                            "metricName": "Total data received",
                            "legend": "CommonSecurityLog",
                            "baseQuery": "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n"
                        }
                    ],
                    "dataTypes": [
                        {
                            "name": "CommonSecurityLog",
                            "lastDataReceivedQuery": "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                        }
                    ],
                    "connectivityCriterias": [
                        {
                            "type": "IsConnectedQuery",
                            "value": [
                                "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\", \"Votiro\")\n\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(3d)"
                            ]
                        }
                    ],
                    "sampleQueries": [
                        {
                            "query": "\nCommonSecurityLog\u200b \n| where DeviceVendor !in (\"Cisco\",\"Check Point\",\"Palo Alto Networks\",\"Fortinet\",\"F5\",\"Barracuda\",\"ExtraHop\",\"OneIdentity\",\"Zscaler\", \"ForgeRock Inc\", \"Cyber-Ark\", \"illusive\", \"Vectra Networks\", \"Citrix\", \"Darktrace\", \"Akamai\", \"Aruba Networks\", \"CrowdStrike\", \"Symantec\", \"Claroty\", \"Contrast Security\", \"Delinea Software\", \"Thycotic Software\", \"FireEye\", \"Forcepoint CSG\", \"Forcepoint\", \"Forcepoint CASB\", \"iboss\", \"Illumio\", \"Imperva Inc.\", \"Infoblox\", \"Morphisec\", \"Netwrix\", \"Nozomi\", \"Onapsis\", \"OSSEC\", \"PingFederate\", \"RidgeSecurity\", \"SonicWall\", \"Trend Micro\", \"vArmour\")\n\n            | sort by TimeGenerated"
                        }
                    ],
                    "availability": {
                        "status": 1,
                        "isPreview": false
                    },
                    "permissions": {
                        "resourceProvider": [
                            {
                                "provider": "Microsoft.OperationalInsights/workspaces",
                                "permissionsDisplayText": "read and write permissions.",
                                "providerDisplayName": "Workspace",
                                "scope": "Workspace",
                                "requiredPermissions": {
                                    "read": true,
                                    "write": true,
                                    "delete": true
                                }
                            },
                            {
                                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                                "permissionsDisplayText": "read permissions to shared keys for the workspace. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                                "providerDisplayName": "Keys",
                                "scope": "Workspace",
                                "requiredPermissions": {
                                    "action": true
                                }
                            }
                        ]
                    },
                    "instructionSteps": [
                        {
                            "description": "Install and configure the Linux agent to collect your Common Event Format (CEF) Syslog messages and forward them to Microsoft Sentinel.\n\n> Notice that the data from all regions will be stored in the selected workspace",
                            "innerSteps": [
                                {
                                    "title": "1.1 Select or create a Linux machine",
                                    "description": "Select or create a Linux machine that Microsoft Sentinel will use as the proxy between your security solution and Microsoft Sentinel this machine can be on your on-prem environment, Azure or other clouds."
                                },
                                {
                                    "title": "1.2 Install the CEF collector on the Linux machine",
                                    "description": "Install the Microsoft Monitoring Agent on your Linux machine and configure the machine to listen on the necessary port and forward messages to your Microsoft Sentinel workspace. The CEF collector collects CEF messages on port 514 TCP.\n\n> 1. Make sure that you have Python on your machine using the following command: python --version.\n\n> 2. You must have elevated permissions (sudo) on your machine.",
                                    "instructions": [
                                        {
                                            "parameters": {
                                                "fillWith": [
                                                    "WorkspaceId",
                                                    "PrimaryKey"
                                                ],
                                                "label": "Run the following command to install and apply the CEF collector:",
                                                "value": "sudo wget -O cef_installer.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_installer.py&&sudo python cef_installer.py {0} {1}"
                                            },
                                            "type": "CopyableLabel"
                                        }
                                    ]
                                }
                            ],
                            "title": "1. Linux Syslog agent configuration"
                        },
                        {
                            "description": "Set your security solution to send Syslog messages in CEF format to the proxy machine. Make sure you to send the logs to port 514 TCP on the machine\u2019s IP address.",
                            "title": "2. Forward Common Event Format (CEF) logs to Syslog agent"
                        },
                        {
                            "description": "Follow the instructions to validate your connectivity:\n\nOpen Log Analytics to check if the logs are received using the CommonSecurityLog schema.\n\n>It may take about 20 minutes until the connection streams data to your workspace.\n\nIf the logs are not received, run the following connectivity validation script:\n\n> 1. Make sure that you have Python on your machine using the following command: python --version\n\n>2. You must have elevated permissions (sudo) on your machine",
                            "instructions": [
                                {
                                    "parameters": {
                                        "fillWith": [
                                            "WorkspaceId"
                                        ],
                                        "label": "Run the following command to validate your connectivity:",
                                        "value": "sudo wget -O cef_troubleshoot.py https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEF/cef_troubleshoot.py&&sudo python cef_troubleshoot.py  {0}"
                                    },
                                    "type": "CopyableLabel"
                                }
                            ],
                            "title": "3. Validate connection"
                        },
                        {
                            "description": "Make sure to configure the machine's security according to your organization's security policy\n\n\n[Learn more >](https://aka.ms/SecureCEF)",
                            "title": "4. Secure your machine "
                        }
                    ],
                    "id": "CEF"
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring('CefAma')))]",
            "location": "[parameters('workspace-location')]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', 'azuresentinel.azure-sentinel-solution-commoneventformat')]"
            ],
            "properties": {
                "description": "Common Event Format (CEF) is an industry standard format on top of Syslog messages. used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel. you can take advantage of search & correlation. alerting. and threat intelligence enrichment for each log. For more information. see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223547&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
                "mainTemplate": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0",
                    "parameters": {},
                    "variables": {},
                    "resources": [
                        {
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/','CefAma')]",
                            "apiVersion": "2021-03-01-preview",
                            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
                            "location": "[parameters('workspace-location')]",
                            "kind": "StaticUI",
                            "properties": {
                                "connectorUiConfig": {
                                    "id": "CefAma",
                                    "title": "Common Event Format (CEF) via AMA",
                                    "publisher": "Microsoft",
                                    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223547&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
                                    "graphQueries": [
                                        {
                                            "metricName": "Total data received",
                                            "legend": "CommonSecurityLog",
                                            "baseQuery": "CommonSecurityLog"
                                        }
                                    ],
                                    "connectivityCriterias": [
                                        {
                                            "type": "CEFAMA",
                                            "value": null
                                        }
                                    ],
                                    "dataTypes": [
                                        {
                                            "name": "CommonSecurityLog",
                                            "lastDataReceivedQuery": "CommonSecurityLog\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                                        }
                                    ]
                                }
                            }
                        },
                        {
                            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
                            "apiVersion": "2023-04-01-preview",
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CefAma'),'/'))))]",
                            "properties": {
                                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CefAma')]",
                                "contentId": "CefAma",
                                "kind": "DataConnector",
                                "version": "1.0.0",
                                "source": {
                                    "kind": "Solution",
                                    "name": "Common Event Format",
                                    "sourceId": "azuresentinel.azure-sentinel-solution-commoneventformat"
                                },
                                "author": {
                                    "name": "Microsoft",
                                    "email": "support@microsoft.com"
                                },
                                "support": {
                                    "tier": "Microsoft",
                                    "name": "Microsoft Corporation",
                                    "link": "https://support.microsoft.com",
                                    "email": "support@microsoft.com"
                                }
                            }
                        }
                    ]
                },
                "packageKind": "Solution",
                "packageVersion": "3.0.6",
                "packageName": "Common Event Format",
                "packageId": "azuresentinel.azure-sentinel-solution-commoneventformat",
                "contentSchemaVersion": "3.0.0",
                "contentId": "CefAma",
                "contentKind": "DataConnector",
                "displayName": "Common Event Format (CEF) via AMA",
                "contentProductId": "azuresentinel.azure-sentinel-solution-commoneventf-dc-zh6jxy6yyd5ei",
                "id": "azuresentinel.azure-sentinel-solution-commoneventf-dc-zh6jxy6yyd5ei",
                "version": "1.0.0",
                "isDeprecated": false
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CefAma'),'/'))))]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CefAma')]"
            ],
            "location": "[parameters('workspace-location')]",
            "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', 'CefAma')]",
                "contentId": "CefAma",
                "kind": "DataConnector",
                "version": "1.0.0",
                "source": {
                    "kind": "Solution",
                    "name": "Common Event Format",
                    "sourceId": "azuresentinel.azure-sentinel-solution-commoneventformat"
                },
                "author": {
                    "name": "Microsoft",
                    "email": "support@microsoft.com"
                },
                "support": {
                    "tier": "Microsoft",
                    "name": "Microsoft Corporation",
                    "link": "https://support.microsoft.com",
                    "email": "support@microsoft.com"
                }
            }
        },
        {
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/','CefAma')]",
            "apiVersion": "2021-03-01-preview",
            "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
            "location": "[parameters('workspace-location')]",
            "kind": "StaticUI",
            "properties": {
                "connectorUiConfig": {
                    "title": "Common Event Format (CEF) via AMA",
                    "publisher": "Microsoft",
                    "descriptionMarkdown": "Common Event Format (CEF) is an industry standard format on top of Syslog messages, used by many security vendors to allow event interoperability among different platforms. By connecting your CEF logs to Microsoft Sentinel, you can take advantage of search & correlation, alerting, and threat intelligence enrichment for each log. For more information, see the [Microsoft Sentinel documentation](https://go.microsoft.com/fwlink/p/?linkid=2223547&wt.mc_id=sentinel_dataconnectordocs_content_cnl_csasci).",
                    "graphQueries": [
                        {
                            "metricName": "Total data received",
                            "legend": "CommonSecurityLog",
                            "baseQuery": "CommonSecurityLog"
                        }
                    ],
                    "dataTypes": [
                        {
                            "name": "CommonSecurityLog",
                            "lastDataReceivedQuery": "CommonSecurityLog\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                        }
                    ],
                    "connectivityCriterias": [
                        {
                            "type": "CEFAMA",
                            "value": null
                        }
                    ],
                    "id": "CefAma"
                }
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
            "apiVersion": "2023-04-01-preview",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring('CEFOverview')))]",
            "location": "[parameters('workspace-location')]",
            "dependsOn": [
                "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', 'azuresentinel.azure-sentinel-solution-commoneventformat')]"
            ],
            "properties": {
                "description": "This Workbook gives an overview of ingestion of logs in the CommonSecurityLog table.",
                "mainTemplate": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0",
                    "parameters": {},
                    "variables": {},
                    "resources": [
                        {
                            "type": "Microsoft.Insights/workbooks",
                            "name": "CEFOverview",
                            "location": "[parameters('workspace-location')]",
                            "kind": "shared",
                            "apiVersion": "2021-08-01",
                            "metadata": {
                                "description": "This Workbook gives an overview of ingestion of logs in the CommonSecurityLog table."
                            },
                            "properties": {
                                "displayName": "Common Event Format Logs Overview",
                                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"# Common Event Format Logs Overview\\n---\\n\\nThis Workbook gives an overview of ingestion of logs in the CommonSecurityLog table\"},\"name\":\"text - 2\"},{\"type\":1,\"content\":{\"json\":\"## Log Ingestion Overview (Kb)\\r\\n---\"},\"name\":\"text - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog\\n| where TimeGenerated >= ago(30d)\\n| summarize TotalVolumeIngested = round(sum(_BilledSize)/(1024)) by DeviceProduct\",\"size\":1,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"TotalVolumeIngested\"},\"subtitleContent\":{\"columnMatch\":\"DeviceProduct\"},\"showBorder\":true}},\"name\":\"query - 2\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"37fd3af4-5d65-41e2-81ae-0720f281eb04\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Subscription\",\"type\":6,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"includeAll\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":[\"/subscriptions/5733bcb3-7fde-4caf-8629-41dc15e3b352\",\"/subscriptions/ebb79bc0-aa86-44a7-8111-cabbe0c43993\"]},{\"id\":\"0407e413-4562-4a87-b660-72facb921954\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}]},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1800000}},{\"id\":\"f5f6d366-40c3-4b51-a62f-06665d374327\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ConnectedStatus\",\"type\":2,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"CommonSecurityLog  \\r\\n| summarize EventCount_TimeRange =  countif(TimeGenerated {TimeRange}), EventCount_Last30Days = countif(TimeGenerated > ago(30d)) by  DeviceProduct\\r\\n| project ConnectedStatus = iff(EventCount_Last30Days > 0, \\\"Connected\\\", \\\"Not-Connected\\\")\\r\\n| distinct ConnectedStatus\\r\\n| order by ConnectedStatus asc\",\"typeSettings\":{\"showDefault\":false},\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":[\"Connected\"]}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let All_DeviceProduct_Table = CommonSecurityLog | summarize by DeviceProduct;\\r\\nlet OOTBSources = externaldata(ProductName: string)\\r\\n[@\\\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/DataConnectors/CEFConnectors.csv\\\"]\\r\\nwith (format=\\\"csv\\\", ignoreFirstRecord=true);\\r\\nAll_DeviceProduct_Table | join kind=fullouter \\r\\n(CommonSecurityLog  \\r\\n| summarize EventCount_TimeRange =  countif(TimeGenerated {TimeRange}), EventCount_Last30Days = countif(TimeGenerated > ago(30d)) by  DeviceProduct\\r\\n| extend ConnectionStatus = iff(EventCount_Last30Days > 0, \\\"Connected\\\", \\\"Not-Connected\\\")\\r\\n| extend OutofBoxSupport = iif(DeviceProduct in (OOTBSources), \\\"Available\\\", \\\"Unavailable\\\")\\r\\n)\\r\\non DeviceProduct\\r\\n| where ConnectionStatus in ({ConnectedStatus}) \\r\\n| extend DeviceProduct = coalesce(DeviceProduct, DeviceProduct1)\\r\\n| extend EventCount_TimeRange = coalesce(EventCount_TimeRange, 0)\\r\\n| extend EventCount_Last30Days = coalesce(EventCount_Last30Days, 0)\\r\\n| extend ConnectionStatus = coalesce(ConnectionStatus, \\\"Not-Connected\\\")\\r\\n| project-away DeviceProduct1, EventCount_TimeRange\\r\\n//| project DeviceProduct, EventCount_Last30Days, OutofBoxSupport\",\"size\":0,\"timeContext\":{\"durationMs\":2592000000},\"exportFieldName\":\"DeviceProduct\",\"exportParameterName\":\"DeviceProduct\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"ConnectionStatus\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"Connected\",\"representation\":\"success\",\"text\":\"{0}{1}\"},{\"operator\":\"!=\",\"thresholdValue\":\"Connected\",\"representation\":\"error\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"representation\":\"success\",\"text\":\"{0}{1}\"}]},\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"}}},{\"columnMatch\":\"OutofBox\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"Available\",\"representation\":\"Available\",\"text\":\"{0}{1}\"},{\"operator\":\"!=\",\"thresholdValue\":\"Yes\",\"representation\":\"Unavailable\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"representation\":\"success\",\"text\":\"{0}{1}\"}]}}],\"labelSettings\":[{\"columnId\":\"DeviceProduct\",\"label\":\"Device Product\"}]}},\"customWidth\":\"50\",\"name\":\"query - 1 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\" let Now = now();\\r\\n(range TimeGenerated from ago(7d) to Now - 1d step 1d\\r\\n| extend Count = 0\\r\\n| union isfuzzy=true\\r\\n    (CommonSecurityLog\\r\\n    | where DeviceProduct == \\\"{DeviceProduct}\\\"\\r\\n    //| where DeviceProduct has \\\"PAN-OS\\\"\\r\\n    | summarize Count = count() by bin_at(TimeGenerated, 1d, Now))\\r\\n| summarize Count=max(Count) by bin_at(TimeGenerated, 1d, Now)\\r\\n| sort by TimeGenerated\\r\\n| project\\r\\n    Value = iff(isnull(Count), 0, Count),\\r\\n    Time = TimeGenerated,\\r\\n    Legend = \\\"{DeviceProduct}\\\")\\r\\n| render timechart \",\"size\":0,\"timeContext\":{\"durationMs\":604800000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"timechart\",\"chartSettings\":{\"showMetrics\":false}},\"customWidth\":\"50\",\"name\":\"query - 2\"}]},\"name\":\"IngestedLogs\"}],\"fromTemplateId\":\"CEFOverview\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                                "version": "1.0",
                                "sourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
                                "category": "sentinel"
                            }
                        },
                        {
                            "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
                            "apiVersion": "2022-01-01-preview",
                            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(resourceId('Microsoft.Insights/workbooks', 'CEFOverview'),'/'))))]",
                            "properties": {
                                "description": "@{workbookKey=CEFOverview; logoFileName=Azure_Sentinel.svg; description=This Workbook gives an overview of ingestion of logs in the CommonSecurityLog table.; dataTypesDependencies=System.Object[]; dataConnectorsDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=Common Event Format Logs Overview; templateRelativePath=CEFOverviewWorkbook.json; provider=; support=; author=; categories=}.description",
                                "parentId": "[resourceId('Microsoft.Insights/workbooks', 'CEFOverview')]",
                                "contentId": "CEFOverview",
                                "kind": "Workbook",
                                "version": "1.0.0",
                                "source": {
                                    "kind": "Solution",
                                    "name": "Common Event Format",
                                    "sourceId": "azuresentinel.azure-sentinel-solution-commoneventformat"
                                },
                                "author": {
                                    "name": "Microsoft",
                                    "email": "support@microsoft.com"
                                },
                                "support": {
                                    "tier": "Microsoft",
                                    "name": "Microsoft Corporation",
                                    "link": "https://support.microsoft.com",
                                    "email": "support@microsoft.com"
                                },
                                "dependencies": {
                                    "operator": "AND",
                                    "criteria": [
                                        {
                                            "contentId": "CommonSecurityLog",
                                            "kind": "DataType"
                                        }
                                    ]
                                }
                            }
                        }
                    ]
                },
                "packageKind": "Solution",
                "packageVersion": "3.0.6",
                "packageName": "Common Event Format",
                "packageId": "azuresentinel.azure-sentinel-solution-commoneventformat",
                "contentSchemaVersion": "3.0.0",
                "contentId": "CEFOverview",
                "contentKind": "Workbook",
                "displayName": "Common Event Format Logs Overview",
                "contentProductId": "azuresentinel.azure-sentinel-solution-commoneventf-wb-3qfrl2wffxmse",
                "id": "azuresentinel.azure-sentinel-solution-commoneventf-wb-3qfrl2wffxmse",
                "version": "1.0.0",
                "isDeprecated": false
            }
        },
        {
            "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
            "apiVersion": "2023-04-01-preview",
            "location": "[parameters('workspace-location')]",
            "properties": {
                "version": "3.0.6",
                "kind": "Solution",
                "contentSchemaVersion": "3.0.0",
                "displayName": "Common Event Format",
                "publisherDisplayName": "Microsoft Sentinel, Microsoft Corporation",
                "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p><p>\u2022 Review the solution <a target=\"_blank\" href=\"https://ms.portal.azure.com/verifyLink?href=https%3A%2F%2Fgithub.com%2FAzure%2FAzure-Sentinel%2Ftree%2Fmaster%2FSolutions%2FCommon%2520Event%2520Format%2FReleaseNotes.md&amp;id=fx\" rel=\"noopener\">Release Notes</a></p><p>\u2022 There may be <a target=\"_blank\" href=\"https://ms.portal.azure.com/verifyLink?href=https%3A%2F%2Faka.ms%2Fsentinelsolutionsknownissues&amp;id=fx\" rel=\"noopener\">known issues</a> pertaining to this Solution, please refer to them before installing.</p><p>The Common Event Format (CEF) solution for Microsoft Sentinel allows you to ingest logs from any product and/or appliance that can send logs in the <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/sentinel/connect-common-event-format?WT.mc_id=Portal-fx\" rel=\"noopener\">Common Event Format (CEF) over Syslog messages</a>.</p><p>Installing this solution will deploy two data connectors,</p><ol><li><b>Common Event Format via AMA</b> - This data connector helps in ingesting CEF formatted logs into your Log Analytics Workspace using the new Azure Monitor Agent. Learn more about ingesting using the new Azure Monitor Agent <a target=\"_blank\" href=\"https://learn.microsoft.com/azure/sentinel/connect-cef-ama\" rel=\"noopener\">here</a>. Microsoft recommends using this Data Connector</li><li><b>Common Event Format via Legacy Agent</b> - This data connector helps in ingesting CEF formatted logs into your Log Analytics Workspace using the legacy Log Analytics agent.</li></ol><p><b>NOTE:</b> After the solution is installed, Microsoft recommends configuring and leveraging the <b>Common Event Format via AMA</b> connector for log ingestion. Legacy connector uses the Log Analytics agent, which is deprecated on <b>Aug 31, 2024,</b> and thus should only be installed where AMA is not supported.</p><p></p><p><b>Underlying Microsoft Technologies used:</b></p><p>This solution takes a dependency on the following technologies, and some of these dependencies either may be in <a target=\"_blank\" href=\"https://azure.microsoft.com/support/legal/preview-supplemental-terms/\" rel=\"noopener\">Preview</a> state or might result in additional ingestion or operational costs:</p><p>a. <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/sentinel/connect-common-event-format?WT.mc_id=Portal-fx\" rel=\"noopener\">Agent-based log collection (CEF over Syslog)</a></p><p><strong>Data Connectors:</strong> 2, <strong>Workbooks:</strong> 1</p><p><a target=\"_blank\" href=\"https://aka.ms/azuresentinel\" rel=\"noopener\">Learn more about Microsoft Sentinel</a> | <a target=\"_blank\" href=\"https://aka.ms/azuresentinelsolutionsdoc\" rel=\"noopener\">Learn more about Solutions</a></p>",
                "contentKind": "Solution",
                "contentProductId": "azuresentinel.azure-sentinel-solution-commoneventf-sl-3tocv4gk7s74g",
                "id": "azuresentinel.azure-sentinel-solution-commoneventf-sl-3tocv4gk7s74g",
                "icon": "https://store-images.s-microsoft.com/image/apps.64828.04050cde-d5d0-47ee-8577-c53e3dd96f3e.8d36a8ed-a609-4719-ad1b-1581269ebbc5.4a81323c-9d10-401e-b36a-c8150a48ac34",
                "contentId": "azuresentinel.azure-sentinel-solution-commoneventformat",
                "parentId": "azuresentinel.azure-sentinel-solution-commoneventformat",
                "source": {
                    "kind": "Solution",
                    "name": "Common Event Format",
                    "sourceId": "azuresentinel.azure-sentinel-solution-commoneventformat"
                },
                "author": {
                    "name": "Microsoft",
                    "email": "support@microsoft.com"
                },
                "support": {
                    "name": "Microsoft Corporation",
                    "email": "support@microsoft.com",
                    "tier": "Microsoft",
                    "link": "https://support.microsoft.com"
                },
                "dependencies": {
                    "operator": "AND",
                    "criteria": [
                        {
                            "kind": "DataConnector",
                            "contentId": "CEF",
                            "version": "1.0.0"
                        },
                        {
                            "kind": "DataConnector",
                            "contentId": "CefAma",
                            "version": "1.0.0"
                        },
                        {
                            "kind": "Workbook",
                            "contentId": "CEFOverview",
                            "version": "1.0.0"
                        }
                    ]
                },
                "firstPublishDate": "2022-05-30",
                "providers": [
                    "Microsoft"
                ],
                "categories": {
                    "domains": [
                        "IT Operations"
                    ]
                },
                "isPreview": false,
                "isDeprecated": false,
                "migratedToPackageId": null
            },
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'azuresentinel.azure-sentinel-solution-commoneventformat')]"
        }
    ],
    "variables": {}
}
